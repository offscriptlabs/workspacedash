{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{RefreshCw,CheckCircle,AlertCircle,Clock,MapPin,Truck}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TrackingStatusComponent=_ref=>{let{trackingNumber,currentStatus,onStatusUpdate,onEstimatedDeliveryUpdate}=_ref;const[trackingData,setTrackingData]=useState(null);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[lastUpdated,setLastUpdated]=useState(null);const[isInitialized,setIsInitialized]=useState(false);const fetchTrackingStatus=useCallback(async()=>{if(!trackingNumber)return;console.log('Fetching tracking status for:',trackingNumber);setIsLoading(true);setError(null);try{// Import the tracking service (mock or real based on environment)\nconst{getTrackingService}=await import('../services/trackshipApi');console.log('Getting tracking service...');const trackingService=getTrackingService();console.log('Tracking service obtained, making API call...');const status=await trackingService.getTrackingStatus(trackingNumber);console.log('API call completed, status:',status);setTrackingData(status);setLastUpdated(new Date());// Update parent component with new status\nonStatusUpdate(status.status);if(status.estimatedDelivery&&onEstimatedDeliveryUpdate){onEstimatedDeliveryUpdate(status.estimatedDelivery);}}catch(err){setError(err instanceof Error?err.message:'Failed to fetch tracking status');}finally{setIsLoading(false);}},[trackingNumber]);// Remove onStatusUpdate and onEstimatedDeliveryUpdate from dependencies\nuseEffect(()=>{if(trackingNumber&&!isInitialized){// Only fetch on initial load\nfetchTrackingStatus();setIsInitialized(true);}},[trackingNumber,fetchTrackingStatus,isInitialized]);const getStatusIcon=status=>{switch(status){case'delivered':return/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-success-600\"});case'shipped':return/*#__PURE__*/_jsx(Clock,{className:\"w-4 h-4 text-primary-600\"});case'pending':return/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 text-warning-600\"});default:return/*#__PURE__*/_jsx(Clock,{className:\"w-4 h-4 text-gray-600\"});}};const getStatusColor=status=>{switch(status){case'delivered':return'bg-success-100 text-success-800 border-success-200';case'shipped':return'bg-primary-100 text-primary-800 border-primary-200';case'pending':return'bg-warning-100 text-warning-800 border-warning-200';default:return'bg-gray-100 text-gray-800 border-gray-200';}};if(!trackingNumber){return/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"No tracking number available\"});}if(isLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4 animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Updating tracking...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-sm text-red-600\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Tracking unavailable\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchTrackingStatus,className:\"text-xs text-primary-600 hover:text-primary-700 transition-colors duration-200\",children:\"Retry\"})]});}if(!trackingData){return/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Loading tracking information...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[getStatusIcon(trackingData.status),/*#__PURE__*/_jsx(\"span\",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(trackingData.status)}`,children:trackingData.statusDescription})]}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchTrackingStatus,disabled:isLoading,className:\"text-xs text-primary-600 hover:text-primary-700 transition-colors duration-200 disabled:opacity-50\",children:/*#__PURE__*/_jsx(RefreshCw,{className:`w-3 h-3 ${isLoading?'animate-spin':''}`})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600 space-y-1\",children:[trackingData.carrier&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Truck,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:trackingData.carrier})]}),trackingData.currentLocation&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:trackingData.currentLocation})]}),trackingData.lastActivity&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Last activity: \",new Date(trackingData.lastActivity).toLocaleString()]}),trackingData.estimatedDelivery&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Est. delivery: \",new Date(trackingData.estimatedDelivery).toLocaleDateString()]}),lastUpdated&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-400\",children:[\"Updated: \",lastUpdated.toLocaleTimeString()]})]})]});};export default TrackingStatusComponent;","map":{"version":3,"names":["React","useState","useEffect","useCallback","RefreshCw","CheckCircle","AlertCircle","Clock","MapPin","Truck","jsx","_jsx","jsxs","_jsxs","TrackingStatusComponent","_ref","trackingNumber","currentStatus","onStatusUpdate","onEstimatedDeliveryUpdate","trackingData","setTrackingData","isLoading","setIsLoading","error","setError","lastUpdated","setLastUpdated","isInitialized","setIsInitialized","fetchTrackingStatus","console","log","getTrackingService","trackingService","status","getTrackingStatus","Date","estimatedDelivery","err","Error","message","getStatusIcon","className","getStatusColor","children","onClick","statusDescription","disabled","carrier","currentLocation","lastActivity","toLocaleString","toLocaleDateString","toLocaleTimeString"],"sources":["/Users/peterrousseau/Shipping Dashboard/src/components/TrackingStatus.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { RefreshCw, CheckCircle, AlertCircle, Clock, MapPin, Truck } from 'lucide-react';\nimport { TrackingStatus } from '../services/trackshipApi';\n\ninterface TrackingStatusProps {\n  trackingNumber: string;\n  currentStatus: 'pending' | 'shipped' | 'delivered';\n  onStatusUpdate: (status: 'pending' | 'shipped' | 'delivered') => void;\n  onEstimatedDeliveryUpdate?: (date: string) => void;\n}\n\nconst TrackingStatusComponent: React.FC<TrackingStatusProps> = ({\n  trackingNumber,\n  currentStatus,\n  onStatusUpdate,\n  onEstimatedDeliveryUpdate,\n}) => {\n  const [trackingData, setTrackingData] = useState<TrackingStatus | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n  const [isInitialized, setIsInitialized] = useState(false);\n\n  const fetchTrackingStatus = useCallback(async () => {\n    if (!trackingNumber) return;\n\n    console.log('Fetching tracking status for:', trackingNumber);\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Import the tracking service (mock or real based on environment)\n      const { getTrackingService } = await import('../services/trackshipApi');\n      \n      console.log('Getting tracking service...');\n      const trackingService = getTrackingService();\n      console.log('Tracking service obtained, making API call...');\n      \n      const status = await trackingService.getTrackingStatus(trackingNumber);\n      console.log('API call completed, status:', status);\n      setTrackingData(status);\n      setLastUpdated(new Date());\n      \n      // Update parent component with new status\n      onStatusUpdate(status.status);\n      \n      if (status.estimatedDelivery && onEstimatedDeliveryUpdate) {\n        onEstimatedDeliveryUpdate(status.estimatedDelivery);\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch tracking status');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [trackingNumber]); // Remove onStatusUpdate and onEstimatedDeliveryUpdate from dependencies\n\n  useEffect(() => {\n    if (trackingNumber && !isInitialized) {\n      // Only fetch on initial load\n      fetchTrackingStatus();\n      setIsInitialized(true);\n    }\n  }, [trackingNumber, fetchTrackingStatus, isInitialized]);\n\n  const getStatusIcon = (status: 'pending' | 'shipped' | 'delivered') => {\n    switch (status) {\n      case 'delivered':\n        return <CheckCircle className=\"w-4 h-4 text-success-600\" />;\n      case 'shipped':\n        return <Clock className=\"w-4 h-4 text-primary-600\" />;\n      case 'pending':\n        return <AlertCircle className=\"w-4 h-4 text-warning-600\" />;\n      default:\n        return <Clock className=\"w-4 h-4 text-gray-600\" />;\n    }\n  };\n\n  const getStatusColor = (status: 'pending' | 'shipped' | 'delivered') => {\n    switch (status) {\n      case 'delivered':\n        return 'bg-success-100 text-success-800 border-success-200';\n      case 'shipped':\n        return 'bg-primary-100 text-primary-800 border-primary-200';\n      case 'pending':\n        return 'bg-warning-100 text-warning-800 border-warning-200';\n      default:\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  if (!trackingNumber) {\n    return (\n      <div className=\"text-sm text-gray-500\">\n        No tracking number available\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n        <RefreshCw className=\"w-4 h-4 animate-spin\" />\n        <span>Updating tracking...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-2 text-sm text-red-600\">\n          <AlertCircle className=\"w-4 h-4\" />\n          <span>Tracking unavailable</span>\n        </div>\n        <button\n          onClick={fetchTrackingStatus}\n          className=\"text-xs text-primary-600 hover:text-primary-700 transition-colors duration-200\"\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  if (!trackingData) {\n    return (\n      <div className=\"text-sm text-gray-500\">\n        Loading tracking information...\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      {/* Status Badge */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-2\">\n          {getStatusIcon(trackingData.status)}\n          <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(trackingData.status)}`}>\n            {trackingData.statusDescription}\n          </span>\n        </div>\n        \n        <button\n          onClick={fetchTrackingStatus}\n          disabled={isLoading}\n          className=\"text-xs text-primary-600 hover:text-primary-700 transition-colors duration-200 disabled:opacity-50\"\n        >\n          <RefreshCw className={`w-3 h-3 ${isLoading ? 'animate-spin' : ''}`} />\n        </button>\n      </div>\n\n      {/* Tracking Details */}\n      <div className=\"text-xs text-gray-600 space-y-1\">\n        {trackingData.carrier && (\n          <div className=\"flex items-center space-x-1\">\n            <Truck className=\"w-3 h-3\" />\n            <span className=\"font-medium\">{trackingData.carrier}</span>\n          </div>\n        )}\n        \n        {trackingData.currentLocation && (\n          <div className=\"flex items-center space-x-1\">\n            <MapPin className=\"w-3 h-3\" />\n            <span>{trackingData.currentLocation}</span>\n          </div>\n        )}\n        \n        {trackingData.lastActivity && (\n          <div>\n            Last activity: {new Date(trackingData.lastActivity).toLocaleString()}\n          </div>\n        )}\n        \n        {trackingData.estimatedDelivery && (\n          <div>\n            Est. delivery: {new Date(trackingData.estimatedDelivery).toLocaleDateString()}\n          </div>\n        )}\n        \n        {lastUpdated && (\n          <div className=\"text-gray-400\">\n            Updated: {lastUpdated.toLocaleTimeString()}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TrackingStatusComponent; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}